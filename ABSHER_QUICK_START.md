# دليل الاستخدام السريع - تكامل أبشر

## 🚀 البدء السريع

### 1. تشغيل النظام

```bash
# Backend
cd backend
npm install
npm start

# Frontend
cd frontend
npm install
npm run dev
```

### 2. إعداد أبشر (خطوات سريعة)

1. سجل الدخول إلى النظام
2. اذهب إلى تبويب **"Absher Integration"**
3. أدخل البيانات التالية:
   ```
   رقم العميل: 70e8c31b
   الكتلة السرية: f90e9f9e07ec345bc121f8d745a73be7
   خادم المصادقة: https://iam.apps.devnet.elm.sa
   اسم المجال: tamm-QA
   ```
4. اضغط **"اختبار الاتصال"**
5. اضغط **"حفظ"**

### 3. مزامنة المركبات

1. اذهب إلى تبويب **"Vehicles"**
2. اضغط زر **"🔄 Sync with Absher"**
3. انتظر حتى تكتمل المزامنة

✅ تم! الآن جميع بيانات المركبات محدثة من أبشر

---

## 📋 ما الذي تم إضافته؟

### ✨ ميزات جديدة:

1. **صفحة إدارة أبشر**
   - إدارة بيانات الاتصال بـ API أبشر
   - اختبار الاتصال
   - عرض تاريخ آخر مزامنة

2. **زر المزامنة في صفحة المركبات**
   - مزامنة جميع المركبات بضغطة زر
   - عرض نتائج المزامنة (نجاح/فشل)
   - عرض الأخطاء التفصيلية

3. **حقول جديدة للمركبات**
   - شركة التأمين
   - رقم وثيقة التأمين
   - تاريخ انتهاء التأمين
   - مصدر البيانات (يدوي/أبشر/استيراد)
   - تاريخ آخر مزامنة

4. **إشعارات التأمين**
   - إشعار قبل 10 أيام من انتهاء التأمين
   - إشعار بريد إلكتروني + push notification

---

## 🔧 الملفات المضافة

### Backend
```
backend/
├── services/absherService.js       # خدمة API أبشر
├── models/AbsherConfig.js          # نموذج الإعدادات
├── routes/absherRoutes.js          # API endpoints
└── .env                            # تم إضافة إعدادات أبشر
```

### Frontend
```
frontend/
└── src/components/absher/
    └── AbsherIntegrationSettings.jsx  # صفحة إدارة أبشر
```

---

## 📝 الملاحظات الهامة

⚠️ **متطلبات المزامنة:**
- يجب أن تحتوي المركبة على:
  - رقم لوحة (Plate Number)
  - رقم تسلسلي (Sequence Number)

⚠️ **الأمان:**
- بيانات Client Secret مشفرة في قاعدة البيانات
- Token يتم تخزينه مؤقتاً في الذاكرة
- جميع الطلبات تتطلب مصادقة

⚠️ **معدل الطلبات:**
- تأخير 500ms بين كل طلب
- لتجنب تجاوز حدود API أبشر

---

## 🆘 مشاكل شائعة وحلولها

### ❌ "Failed to authenticate"
**الحل:** تحقق من صحة Client ID و Client Secret

### ❌ "Vehicle not found"
**الحل:** تأكد من صحة رقم اللوحة والرقم التسلسلي

### ❌ "Connection timeout"
**الحل:** تحقق من الاتصال بالإنترنت و URL الخادم

---

## 📞 الدعم

- **البريد الإلكتروني**: gts.development.team@gmail.com
- **التوثيق الكامل**: انظر ملف [ABSHER_INTEGRATION.md](./ABSHER_INTEGRATION.md)

---

تم التطوير بواسطة GTS Development Team 🚀
